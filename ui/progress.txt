# Progress Log

Project: loopship-ui
Started: 2026-01-07
Goal: Premium dark UI for LoopShip loop monitoring

## Design Decisions

- Near-black background (#0a0a0a) not dark gray
- Amber-500 as only accent color
- Inter + Geist Mono fonts
- Minimal, no decorative elements
- Think: Linear, Raycast, Vercel dashboard

## Learnings

### Story 1: Project scaffold with Vite + React + Tailwind
- Vite 7.x with @tailwindcss/vite plugin is the modern way (not PostCSS config)
- Tailwind 4 uses `@import "tailwindcss"` instead of the old @tailwind directives
- Google Fonts provides both Inter and Geist Mono
- Keep the base component minimal - just a centered h1 on the dark background
- Screenshot verified: near-black (#0a0a0a) background with centered "LoopShip" title

### Story 2: Layout shell with sidebar and main panel
- Created components directory with Layout.jsx containing both Sidebar and Layout components
- Sidebar uses w-60 (240px) with subtle border-white/10 separator
- Mobile responsive: sidebar hidden by default with hamburger menu toggle
- Used transform/translate for smooth mobile slide-in animation
- Screenshot verified: sidebar on left with logo, Dashboard/History nav, main content area on right

### Story 3: Story list component with status indicators
- StoryList component with StatusDot, PriorityBadge, and StoryItem sub-components
- Status colors: zinc-500 (pending), amber-500 (running), green-500 (passed), red-500 (failed), zinc-400 (blocked)
- Running status uses Tailwind's animate-ping for subtle pulse effect
- Passed stories use opacity-60 to appear muted
- Mock data in src/data/mockStories.js with 5 stories in various states
- Clean list style with hover:bg-white/5 for subtle interactivity
- Screenshot verified: all status dots visible with correct colors, passed stories dimmed

### Story 4: Output panel with monospace log
- Created OutputPanel component with dark surface background and subtle border
- Used Geist Mono font (font-mono class) for all log text
- Auto-scroll implemented with useEffect that scrolls to bottom when lines change
- Smart scroll detection: if user scrolls up, auto-scroll pauses; resumes when at bottom
- Syntax highlighting via line types: green-400 for success, red-400 for errors, cyan-400 for file paths
- Mock output data in src/data/mockOutput.js with realistic agent log messages
- Clear button in header resets output via state lift to App.jsx
- Screenshot verified: monospace log visible with colored syntax highlighting, all message types displayed correctly

### Story 5: Control bar with Start/Stop buttons
- ControlBar component with status indicator on left, controls on right
- Status shows Idle/Running/Complete with appropriate colors (white/50, amber-500, green-500)
- Running status includes animated pulse dot and story count (e.g., "Running Story 3/8")
- Start button amber accent when idle, disabled when complete
- Stop button replaces Start when running, styled with red-400
- Keyboard shortcut Cmd+Enter handled via useEffect, hint shown as "⌘↵"
- Clean button styling: subtle hover states with bg color change, not chunky
- Screenshot verified: control bar at top with Idle status and amber Start button with keyboard hint

### Story 6: WebSocket client for live updates
- Created useLoopSocket hook in src/hooks/useLoopSocket.js
- Manages WebSocket connection to ws://localhost:3099 with exponential backoff reconnection
- Initial retry delay: 1s, max delay: 30s, multiplier: 2x
- Handles all event types: story_start, story_end, output, loop_complete, error, stories, status
- Exposes: connected, stories, output, status, startLoop, stopLoop, clearOutput, send
- All message handlers defined inside useEffect to avoid ESLint immutability warnings
- Falls back to mock data when WebSocket not connected
- Added ConnectionIndicator component in Layout.jsx showing green/zinc dot with text
- Connection indicator placed at bottom of sidebar with subtle border-t separator
- App.jsx integrates hook and passes connected prop to Layout

### Story 7: Progress summary and timing
- Created ProgressSummary component showing stories completed/total with percentage
- Elapsed time updates every second via setInterval when status is 'running'
- Estimated remaining calculated from average time per completed story
- Progress bar uses h-1 (4px) with amber-500 fill and white/10 background track
- StoryItem updated with hover tooltip showing duration for completed stories
- Tooltip uses group/group-hover pattern with opacity transition
- Mock data extended with duration field (in seconds) for completed stories
- Loop start time tracked in App.jsx state and passed to ProgressSummary
- Screenshot verified: progress bar visible at 60% (3/5 stories), elapsed time shows 0s
